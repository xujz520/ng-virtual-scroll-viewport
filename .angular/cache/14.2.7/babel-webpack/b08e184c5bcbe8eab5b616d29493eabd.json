{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport * as Mock from 'mockjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"./virtual-scroll-viewport.component\";\nconst _c0 = [\"viewport\"];\n\nfunction TableComponent_th_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r3 = ctx.$implicit;\n    i0.ɵɵclassMap(column_r3.className);\n    i0.ɵɵproperty(\"ngStyle\", column_r3.style);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(column_r3.title);\n  }\n}\n\nfunction TableComponent_tr_8_td_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const column_r6 = i0.ɵɵnextContext().$implicit;\n    const data_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(data_r4[column_r6.field]);\n  }\n}\n\nfunction TableComponent_tr_8_td_1_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 9);\n    i0.ɵɵtext(1, \"\\u7F16\\u8F91\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(2, \"\\u00A0 \");\n    i0.ɵɵelementStart(3, \"button\", 10);\n    i0.ɵɵtext(4, \"\\u5220\\u9664\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TableComponent_tr_8_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 6);\n    i0.ɵɵtemplate(1, TableComponent_tr_8_td_1_ng_container_1_Template, 2, 1, \"ng-container\", 7);\n    i0.ɵɵtemplate(2, TableComponent_tr_8_td_1_ng_template_2_Template, 5, 0, \"ng-template\", null, 8, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r6 = ctx.$implicit;\n\n    const _r8 = i0.ɵɵreference(3);\n\n    i0.ɵɵclassMap(column_r6.className);\n    i0.ɵɵproperty(\"ngStyle\", column_r6.style);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", column_r6.field !== \"#btn\")(\"ngIfElse\", _r8);\n  }\n}\n\nfunction TableComponent_tr_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, TableComponent_tr_8_td_1_Template, 4, 6, \"td\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.columns);\n  }\n}\n\nexport let TableComponent = /*#__PURE__*/(() => {\n  class TableComponent {\n    constructor() {\n      this.columns = [{\n        title: '#',\n        field: 'id',\n        className: 'sticky-left',\n        style: {\n          width: '55px',\n          'min-width': '55px',\n          'text-align': 'center'\n        }\n      }, {\n        title: '姓名',\n        field: 'name',\n        className: 'sticky-left',\n        style: {\n          left: '55px'\n        }\n      }, {\n        title: '学号',\n        field: 'no'\n      }, {\n        title: '性别',\n        field: 'sex'\n      }, {\n        title: '年龄',\n        field: 'age'\n      }, {\n        title: '学院',\n        field: 'college'\n      }, {\n        title: '专业',\n        field: 'major'\n      }, {\n        title: '班级',\n        field: 'class'\n      }, {\n        title: '入学时间',\n        field: 'entranceTime'\n      }, {\n        title: '奖学金',\n        field: 'scholarship'\n      }, {\n        title: '社团',\n        field: 'club'\n      }, {\n        title: '操作项',\n        field: '#btn',\n        className: 'sticky-right'\n      }];\n      this.list = [];\n      this.lastScrollLeft = null;\n      this.xScrollbarPosition = null;\n      this.viewportElementRef = null;\n      const total = 5000;\n      this.list = Mock.mock({\n        [`data|${total}`]: [{\n          \"id|+1\": 1,\n          \"no|+1\": 7107320614,\n          \"name\": \"@cname\",\n          \"sex|1\": ['男', '女'],\n          \"age|18-30\": 18,\n          \"college|1\": ['物联网工程学院', '外语外贸学院', '土木工程学院'],\n          \"major|1\": ['软件工程', '网络工程', '人工智能', '商务英语', '国际贸易实务', '国际邮轮乘务管理', '工程造价', '建筑工程技术', '工程造价管理'],\n          \"class|1-5\": 1,\n          \"entranceTime\": () => Mock.mock('@date(\"yyyy/MM/dd HH:mm:ss\")'),\n          \"scholarship|8000-20000\": 0,\n          \"club\": () => [\"民乐\", \"摄影\", \"骑行\", \"电竞\"].slice(0, Mock.mock('@integer(0, 3)')),\n          \"remark\": \"<mark>HTML</mark><em>备注</em>\",\n          \"status|0-1\": 0\n        }]\n      }).data;\n    }\n\n    trackBy(index, rowData) {\n      return index;\n    }\n\n    onScroll() {\n      const scrollLeft = this.viewportElementRef.nativeElement.scrollLeft;\n      if (this.lastScrollLeft === scrollLeft) return;\n      this.lastScrollLeft = scrollLeft;\n      this.activeFixedColumn();\n    }\n\n    activeFixedColumn() {\n      this.xScrollbarPosition = null;\n      const scrollLeft = Math.round(this.viewportElementRef.nativeElement.scrollLeft);\n      const scrollWidth = Math.round(this.viewportElementRef.nativeElement.scrollWidth);\n      const clientWidth = Math.round(this.viewportElementRef.nativeElement.clientWidth);\n      if (scrollWidth <= clientWidth) return;\n\n      switch (true) {\n        case scrollLeft === 0:\n          {\n            this.xScrollbarPosition = 'x-scrollbar-in-start';\n            break;\n          }\n\n        case [scrollWidth, scrollWidth - 1, scrollWidth + 1].includes(scrollLeft + clientWidth):\n          {\n            this.xScrollbarPosition = 'x-scrollbar-in-end';\n            break;\n          }\n\n        default:\n          {\n            this.xScrollbarPosition = 'x-scrollbar-in-middle';\n            break;\n          }\n      }\n    }\n\n  }\n\n  TableComponent.ɵfac = function TableComponent_Factory(t) {\n    return new (t || TableComponent)();\n  };\n\n  TableComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TableComponent,\n    selectors: [[\"app-table\"]],\n    viewQuery: function TableComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5, ElementRef);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.viewportElementRef = _t.first);\n      }\n    },\n    decls: 11,\n    vars: 8,\n    consts: [[1, \"table-container\"], [3, \"list\", \"itemSize\", \"update\", \"scroll\"], [\"viewport\", \"\"], [1, \"table\", \"table-striped\", \"table-hover\"], [3, \"class\", \"ngStyle\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [3, \"ngStyle\"], [4, \"ngIf\", \"ngIfElse\"], [\"btn\", \"\"], [\"type\", \"button\", 1, \"btn\", \"btn-xs\", \"btn-primary\"], [\"type\", \"button\", 1, \"btn\", \"btn-xs\", \"btn-danger\"]],\n    template: function TableComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"virtual-scroll-viewport\", 1, 2);\n        i0.ɵɵlistener(\"update\", function TableComponent_Template_virtual_scroll_viewport_update_1_listener() {\n          return ctx.activeFixedColumn();\n        })(\"scroll\", function TableComponent_Template_virtual_scroll_viewport_scroll_1_listener() {\n          return ctx.onScroll();\n        });\n        i0.ɵɵelementStart(3, \"table\", 3)(4, \"thead\")(5, \"tr\");\n        i0.ɵɵtemplate(6, TableComponent_th_6_Template, 2, 5, \"th\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"tbody\");\n        i0.ɵɵtemplate(8, TableComponent_tr_8_Template, 2, 1, \"tr\", 5);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(9, \"br\");\n        i0.ɵɵtext(10, \" tip: \\u7F29\\u5C0F\\u5C4F\\u5E55\\u6D4B\\u8BD5\\u56FA\\u5B9A\\u5217\\u6C34\\u5E73\\u6EDA\\u52A8 \");\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(2);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassMap(ctx.xScrollbarPosition);\n        i0.ɵɵproperty(\"list\", ctx.list)(\"itemSize\", 40);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.columns);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", _r0.vList)(\"ngForTrackBy\", ctx.trackBy);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i1.NgStyle, i2.VirtualScrollViewportComponent],\n    styles: [\".table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]{max-height:400px;border:1px solid #ddd}.table-container[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{margin:0;white-space:nowrap;border-collapse:separate}.table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;z-index:1}.table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.sticky-left[_ngcontent-%COMP%]{z-index:2}.table-container[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%]{border-top:0}.table-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] ~ th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] ~ td[_ngcontent-%COMP%]{border-left:1px solid #ddd}.sticky-left[_ngcontent-%COMP%]{position:sticky;background:#fff;left:0}.sticky-right[_ngcontent-%COMP%]{position:sticky;background:#fff;right:0}.x-scrollbar-in-start[_ngcontent-%COMP%]   .sticky-right[_ngcontent-%COMP%], .x-scrollbar-in-middle[_ngcontent-%COMP%]   .sticky-right[_ngcontent-%COMP%]{box-shadow:-6px 0 6px #0000001a}.x-scrollbar-in-end[_ngcontent-%COMP%]   .sticky-left[_ngcontent-%COMP%], .x-scrollbar-in-middle[_ngcontent-%COMP%]   .sticky-left[_ngcontent-%COMP%]{box-shadow:6px 0 6px #0000001a}.table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]{overflow:hidden;z-index:1}.table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]:hover{overflow:overlay}.table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgb(0 0 0 / 30%);border-radius:4px}.table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-track, .table-container[_ngcontent-%COMP%]   virtual-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background:rgb(0 0 0 / 6%)}\"],\n    changeDetection: 0\n  });\n  return TableComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}